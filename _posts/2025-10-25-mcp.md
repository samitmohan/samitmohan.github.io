---
layout: post
title:  "mcp servers"
date:   2025-10-25 14:06:04 +0530
categories: tech
---
MCP (Model Context Protocol) servers are like web APIs‚Äîbut built for LLM interactions. With them, language models like Claude or ChatGPT can do things, not just talk about them.

I‚Äôm always listening to music and creating playlists on Spotify, and I use LLMs daily in my browser. But until now, there was no easy way to control Spotify using an LLM.

That‚Äôs where MCP Servers come in.

#### ‚ùå Why LLMs Don‚Äôt Recognize Spotify Natively
![LLMs Doesn't Recognise Spotify](https://i.ibb.co/M5np2GCf/Screenshot-2025-04-23-at-1-57-06-PM.png)


You can read more about them [here](https://modelcontextprotocol.io/examples)

#### üñ•Ô∏è How It Works
![How it Works](https://i.ibb.co/VWb2BcTj/Screenshot-2025-04-23-at-1-42-10-PM.png)

#### üìù What I Wanted to Do
- Play, pause, and skip tracks via Claude
- Queue songs by name or mood
- Get quick info about the music
- Make playlist according to 'vibes' 
- Ability to manipulate music and my current playlists on Spotify

### Model

Under the hood, I used the Spotipy Web API plus the MCP integration for Claude. After setting up Spotify credentials and installing the right dependencies, here is a sample of server.py file:-

```python
# server.py
import mcp.server.fastmcp
from spotipy import Spotify
from spotipy.oauth2 import SpotifyOAuth

auth = SpotifyOAuth(
    client_id="id",
    client_secret="secret",
    redirect_uri="uri",
    scope="user-modify-playback-state user-read-playback-state user-read-currently-playing",
    cache_path=".cache",
    open_browser=True
)

# caches the access token to avoid repeatedly requesting permission from Spotify
token_info = auth.get_access_token(as_dict=False)
sp = Spotify(auth_manager=auth)

# Create an MCP server
server = mcp.server.fastmcp.FastMCP("Demo")

# Spotify tools
@server.tool()
def play_music():
    # code for playing music

@server.tool()
def pause_music():
    # code for pause

if __name__ == "__main__":
    server.run(transport='stdio')
```

You also need to integrate this into Claude (Desktop Local App) via the claude_desktop_config.json file -:

```json
{
  "mcpServers": {
      "spotify": {
          "command": "/Users/smol/.local/bin/uv",
          "args": [
              "--directory",
              "/Users/smol/fun/mcp-server/mcp-server-demo",
              "run",
              "server.py"
          ]
      }
  }
}
```
Then
```python
mcp run server.py
```

**Now Claude can use your Spotify tools!**

![MCP Tools in Claude](https://i.ibb.co/ccQ1DhR6/Screenshot-2025-04-23-at-12-47-26-PM.png)

### In action

![Claude Talking to Spotify](https://i.ibb.co/qM77jFhF/Screenshot-2025-04-23-at-11-33-09-PM.png)

![Spotify2](https://i.ibb.co/RpLXbXt8/Screenshot-2025-04-25-at-12-49-28-AM.png)

![Spotify3](https://i.ibb.co/BVFF6S0Q/Screenshot-2025-04-25-at-12-23-44-AM.png)

[Video Link](https://youtu.be/BExl8jhthoE)

### Features

#### Music Playback Control
- **Play, Pause & Skip:** Instantly play, pause, skip to the next track, or return to the previous one.
- **Queue Management:** Add specific songs to your playback queue, or play a particular track of your choice.
- **Current Track Info:** Find out what‚Äôs currently playing, or get detailed information about the song, such as its album, artist, and release date.
- **Playback Settings:** Enable shuffle or repeat mode to tailor your listening experience.
- **Album Playback:** Play an entire album directly with a simple command.

#### Playlist Management
- **Create Playlists:** Generate playlists based on different moods (e.g., happy, chill, energetic) or vibes, and add specific songs to them.
- **Playlist Access:** Retrieve a list of all your playlists and view the songs within each.
- **Mood-Based Playlists:** Create dynamic playlists that match specific moods or themes.
- **Delete Playlists:** If you're done with a playlist, you can easily remove it.

#### Additional Spotify Features
- **Liked Songs & Recently Played:** Access all your liked songs or view the recently played artists and tracks.
- **Artist Information:** Fetch all albums from a specific artist for easy access to their entire discography.

#### Functions & Commands:
- **previous_track():** Skip back to the previous track in the playlist.
- **get_info():** Get detailed information about the current song, including its release date, album, and artist.
- **get_lyrics():** Gets lyrics from genius API

#### TODO
- ~300 lines, how to make this shorter?



Spotify unfortunately is lame. No use of localhost or support for custom HTTPS + removes all fun features like analysing audio. They did this last week, guess I‚Äôm late to the AI learning hype. But MCP servers are growing quickly‚Äîsee other examples at the [official repo](https://github.com/modelcontextprotocol/servers) 

Had to use ngrok for tunneling which seems excessive [localhost](http://localhost) server, other than that the python stuff is pretty basic and mcp does the magic. 

I am surprised by how fast I was able to build this, probably because of the spotipy api but even without that, it won‚Äôt take that much time.

Example of not using spotipy-:
```python
# Raw API sample (if not using Spotipy)
def play_song(access_token, track_uri):
    url = "https://api.spotify.com/v1/me/player/play"
    headers = {"Authorization": f"Bearer {access_token}", "Content-Type": "application/json"}
    data = {"uris": [track_uri]}
    return requests.put(url, headers=headers, json=data).status_code
```

Or you could use flask-:
```python
from flask import Flask, request, jsonify

app = Flask(__name__)

@app.route('/play', methods=['POST'])
def mcp_play():
    data = request.json
    status = play_song(data['token'], data['uri'])
    return jsonify({"status": status})

if __name__ == "__main__":
    app.run(port=5000)

```

LLMs have been mostly observers, not doers.

Would be pretty cool if everyone can control their 3rd party apps via LLMs. Creating a trading account bot which talks to LLM or flight booking APIs so I don't have to open MMT or Zerodha everytime I've to purchase a ticket/stock should be easy now. I can just tell Claude to do it for me.

[Github Link](tab:https://github.com/samitmohan/spotify-mcp)


